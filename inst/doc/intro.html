<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Kristian Hovde Liland, Hilde Vinje and Lars Snipen" />

<meta name="date" content="2017-08-10" />

<title>Introduction to microclass</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">Introduction to microclass</h1>
<h4 class="author"><em>Kristian Hovde Liland, Hilde Vinje and Lars Snipen</em></h4>
<h4 class="date"><em>2017-08-10</em></h4>



<div id="k-mers" class="section level2">
<h2>K-mers</h2>
<p>All methods in this package are based on K-mer counting. K-mers are words of length <span class="math inline">\(K\)</span>, found in the sequence being analysed. There are <span class="math inline">\(4^K\)</span> possible words of length <span class="math inline">\(K\)</span>, and all instances in a sequene are counted. Given the sequence “ATGCCTGAACTGACCTGC” we can, for instance, count 1-mers, 2-mers and 3-mers as follows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(microclass)
<span class="kw">KmerCount</span>(<span class="st">&quot;ATGCCTGAACTGACCTGC&quot;</span>, <span class="dt">K=</span><span class="dv">1</span>, <span class="dt">col.names =</span> <span class="ot">TRUE</span>)</code></pre></div>
<pre><code>##      A C G T
## [1,] 4 6 4 4</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">KmerCount</span>(<span class="st">&quot;ATGCCTGAACTGACCTGC&quot;</span>, <span class="dt">K=</span><span class="dv">2</span>, <span class="dt">col.names =</span> <span class="ot">TRUE</span>)</code></pre></div>
<pre><code>##      AA AC AG AT CA CC CG CT GA GC GG GT TA TC TG TT
## [1,]  1  2  0  1  0  2  0  3  2  2  0  0  0  0  4  0</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">KmerCount</span>(<span class="st">&quot;ATGCCTGAACTGACCTGC&quot;</span>, <span class="dt">K=</span><span class="dv">3</span>, <span class="dt">col.names =</span> <span class="ot">TRUE</span>)</code></pre></div>
<pre><code>##      AAA AAC AAG AAT ACA ACC ACG ACT AGA AGC AGG AGT ATA ATC ATG ATT CAA
## [1,]   0   1   0   0   0   1   0   1   0   0   0   0   0   0   1   0   0
##      CAC CAG CAT CCA CCC CCG CCT CGA CGC CGG CGT CTA CTC CTG CTT GAA GAC
## [1,]   0   0   0   0   0   0   2   0   0   0   0   0   0   3   0   1   1
##      GAG GAT GCA GCC GCG GCT GGA GGC GGG GGT GTA GTC GTG GTT TAA TAC TAG
## [1,]   0   0   0   1   0   0   0   0   0   0   0   0   0   0   0   0   0
##      TAT TCA TCC TCG TCT TGA TGC TGG TGT TTA TTC TTG TTT
## [1,]   0   0   0   0   0   2   2   0   0   0   0   0   0</code></pre>
</div>
<div id="classification-in-one-line-of-code" class="section level2">
<h2>Classification in one line of code</h2>
<p>The quickest way to perform prokaryote classification is through the <code>taxMachine</code>. It is a genus level classification methods based on the multinomial method, trained on the <code>microcontax</code> data set.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(small.16S)
tax.tab &lt;-<span class="st"> </span><span class="kw">taxMachine</span>(small.16S$Sequence)</code></pre></div>
<pre><code>## Welcome to the taxMachine!
##    classifying 71 sequences with median length 1338 ...
##    creating model...
##    caching model...
##    classifying sequence 1 to 71 
## done!</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(tax.tab)</code></pre></div>
<pre><code>##          Genus  D.score     R.score P.recognized
## 1 Caldisphaera 7.950911  0.05188227   1.00000000
## 2 Caldisphaera 8.692077 -0.07626455   0.18882257
## 3 Caldisphaera 8.653983  0.22779976   1.00000000
## 4 Caldisphaera 8.549670  0.23457126   1.00000000
## 5 Caldisphaera 8.580826  0.28430467   1.00000000
## 6 Caldisphaera 8.062746 -1.21785848   0.05899272</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">genus &lt;-<span class="st"> </span><span class="kw">sapply</span>(<span class="kw">strsplit</span>(small.16S$Header,<span class="dt">split=</span><span class="st">&quot; &quot;</span>),function(x){x[<span class="dv">2</span>]})
<span class="kw">cat</span>( <span class="st">&quot;Number of errors:&quot;</span>, <span class="kw">sum</span>(genus !=<span class="st"> </span>tax.tab$Genus) )</code></pre></div>
<pre><code>## Number of errors: 0</code></pre>
<p>Notice that a model is created and cached in memory the first time you call <code>taxMachine()</code> in a session. This is to avoid storing a huge matrix. The next call to <code>taxMachine()</code> in this session will be (much) faster, since it will re-use the created model.</p>
<div id="parallell-computing" class="section level3">
<h3>Parallell computing</h3>
<p>The number of processing cores to be used is controlled by the <code>setParallel()</code> command. The default is to used all available cores (logical and physical). Please remember to set this prior to a call if you run this on a computing cluster!</p>
</div>
</div>
<div id="uncertainty" class="section level2">
<h2>Uncertainty</h2>
<p>All input sequences are given a classification by the <code>taxMachine()</code>, but some may be very uncertain. The <code>taxMachine()</code> also calculates two types of uncertainties: the <code>D.score</code> and the <code>R.score</code>. A small <code>D.score</code> (close to 0, less than 1) indicates an uncertain result because the sequence is also very similar to another genus, i.e. its posterior probability is almost equal for two different genera. The <code>R.score</code> indicates if the sequence is very different from any previously seen sequence, and the more negative the <code>R.score</code>, the more ‘alien’ the sequence is to the <code>taxMachine</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="dt">mar =</span> <span class="kw">c</span>(<span class="fl">2.5</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">1</span>))
<span class="kw">boxplot</span>(tax.tab$D.score, <span class="kw">factor</span>(genus), <span class="dt">main =</span> <span class="st">&quot;D-score&quot;</span>)
<span class="kw">boxplot</span>(tax.tab$R.score, <span class="kw">factor</span>(genus), <span class="dt">main =</span> <span class="st">&quot;R-score&quot;</span>)</code></pre></div>
<div class="figure">
<img src="data:image/png;base64,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" alt="Classification uncertainty scores" />
<p class="caption">Classification uncertainty scores</p>
</div>
<p>Along with each <code>R.score</code> value is also a <code>P.recognized</code> value. This is simply the probability that one of the training data sequences get an <code>R.score</code> of the same value, or lower. It is perhaps easier to interpret than the score itself. We typically use this to mark some sequences as unrecognized, and risky to include in further analyses:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">tax.tab$Is.Recognized &lt;-<span class="st"> </span>tax.tab$P.recognized&gt;<span class="fl">0.01</span>
tax.tab[<span class="dv">35</span>:<span class="dv">45</span>,]</code></pre></div>
<pre><code>##        Genus  D.score     R.score P.recognized Is.Recognized
## 35 Acidianus 5.425759  0.59778317   1.00000000          TRUE
## 36 Acidianus 7.367201  0.14176582   1.00000000          TRUE
## 37 Acidianus 5.464705  0.56362329   1.00000000          TRUE
## 38 Acidianus 7.879450 -0.35603991   0.13953400          TRUE
## 39 Acidianus 7.195179  0.09568198   1.00000000          TRUE
## 40 Acidianus 7.832235 -0.44416463   0.12710836          TRUE
## 41 Acidianus 9.064079 -3.69599537   0.00610501         FALSE
## 42 Acidianus 8.097803 -0.93641982   0.07726423          TRUE
## 43 Acidianus 7.438815  0.19891170   1.00000000          TRUE
## 44 Acidianus 7.438897  0.17761285   1.00000000          TRUE
## 45 Acidianus 7.394431  0.26012677   1.00000000          TRUE</code></pre>
<p>In most cases we would accept as recognized any sequence with <code>P.recognized&gt;1e-4</code>, since there is a substantial variation also in ‘proper’ sequences. Sequences with a lot of sequencing errors, chimera or completely new taxa usually get extremely negative <code>R.scores</code>.</p>
</div>
<div id="custom-classification" class="section level2">
<h2>Custom classification</h2>
<p>If classification is to be carried out on a different taxonomic level than genus, using a different training data set, or using different parameters, the RDP and multinomial methods are available.</p>
<p>The following example uses half the <code>small.16</code> data set to train an RDP model and then tries to classify the other half of the data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">rdp &lt;-<span class="st"> </span><span class="kw">rdpTrain</span>(small.16S$Sequence[<span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">71</span>,<span class="dv">2</span>)], genus[<span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">71</span>,<span class="dv">2</span>)])  <span class="co"># training step</span>
predicted &lt;-<span class="st"> </span><span class="kw">rdpClassify</span>(small.16S$Sequence[<span class="kw">seq</span>(<span class="dv">2</span>,<span class="dv">71</span>,<span class="dv">2</span>)], rdp)        <span class="co"># classification step</span>
<span class="kw">cat</span>( <span class="st">&quot;Number of errors:&quot;</span>, <span class="kw">sum</span>(predicted !=<span class="st"> </span>genus[<span class="kw">seq</span>(<span class="dv">2</span>,<span class="dv">71</span>,<span class="dv">2</span>)]) )</code></pre></div>
<pre><code>## Number of errors: 0</code></pre>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
